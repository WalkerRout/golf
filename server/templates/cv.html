{% extends "base.html" %}

{% block title %}Curriculum vitae{% endblock title %}

{% block extra_css %}
  <link rel="preload" href="/static/css/cv.css" as="style">
  <link rel="stylesheet" href="/static/css/cv.css">
{% endblock extra_css %}

{% block extra_js %}
  <!-- its actually just way faster to directly embded javascript into the template... -->
  <!--<script src="/static/js/cv.js"></script>-->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tabContainer = document.querySelector('.cv-menu');
      const tabs = Array.from(tabContainer.querySelectorAll('.cv-tab'));
      const sections = Array.from(document.querySelectorAll('.cv-section'));

      // map tab data attributes to corresponding section elements
      const sectionMap = new Map(
        sections.map(section => [section.id.replace('-tab', ''), section])
      );

      let activeTab = tabContainer.querySelector('.cv-tab.active');
      let activeSection = document.querySelector('.cv-section.active');

      tabContainer.addEventListener('click', (e) => {
        const tab = e.target.closest('.cv-tab');
        if (!tab || tab === activeTab) return;

        const tabKey = tab.dataset.tab;
        const section = sectionMap.get(tabKey);
        if (!section) return;

        // only change classes if different tab clicked
        activeTab.classList.remove('active');
        activeSection.classList.remove('active');

        tab.classList.add('active');
        section.classList.add('active');

        // reset scroll position
        document.querySelector('.cv-content').scrollTop = 0;

        activeTab = tab;
        activeSection = section;
      });
    });
  </script>
{% endblock extra_js %}

{% block content %}
  <div class="cv">
    <div class="cv-menu">
      <button class="cv-tab active" data-tab="summary">Summary</button>
      <button class="cv-tab" data-tab="skills">Skills</button>
      <button class="cv-tab" data-tab="experience">Experience</button>
      <button class="cv-tab" data-tab="education">Education</button>
      <button class="cv-tab" data-tab="projects">Projects</button>
    </div>
    
    <div class="cv-content">
      <div class="cv-section active" id="summary-tab">
        <div class="cv-header">
          <h1>Walker Rout</h1>
          <p class="contact-info">
            <a href="tel:{{ phone_number }}">{{ phone_number }}</a> | 
            <a href="mailto:{{ email_address }}">{{ email_address }}</a> | 
            <a href="{{ website_link }}">Website</a> | 
            <a href="{{ github_link }}">GitHub</a> | 
            <a href="{{ linkedin_link }}">LinkedIn</a>
          </p>
        </div>
        <h2>Professional Summary</h2>
        <p>Curious software developer with extensive experience in LLM retrieval systems, web/backend development, and embedded/systems programming. Experienced in multiple programming languages and technologies, including Rust, Haskell, C, C++, Python, Shell Scripting, C#, JavaScript/HTML/CSS, and SQL databases. Passionate about creating efficient solutions across multiple programming languages and domains, with a strong interest in correctness by construction, abstract algebra, formal languages/compilers, AR/VR/XR/MR technologies, high-performance services, and machine learning.</p>
      </div>

      <div class="cv-section" id="skills-tab">
        <h2>Technical Skills</h2>
        <div class="skills-grid">
          <div class="skill-category">
            <h3>Programming Languages</h3>
            <ul>
              {% for lang in skills.programming_languages %}
                <li>{{ lang }}</li>
              {% endfor %}
            </ul>
          </div>
          <div class="skill-category">
            <h3>Technologies & Frameworks</h3>
            <ul>
              {% for tech in skills.technologies_frameworks %}
                <li>{{ tech }}</li>
              {% endfor %}
            </ul>
          </div>
          <div class="skill-category">
            <h3>Databases & Tools</h3>
            <ul>
              {% for tool in skills.databases_tools %}
                <li>{{ tool }}</li>
              {% endfor %}
            </ul>
          </div>
          <div class="skill-category">
            <h3>Specialised Skills</h3>
            <ul>
              {% for spec in skills.specialised_skills %}
                <li>{{ spec }}</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>

      <div class="cv-section" id="experience-tab">
        <h2>Professional Experience</h2>
        {% for job in experience.entries %}
        <div class="job">
          <h3>{{ job.title }}</h3>
          <p class="job-details">
            {{ job.company }}, {% if job.location.is_some() %}{{ job.location.as_ref().unwrap() }}{% endif %} | 
            {% if job.start.is_some() %}{{ job.start.as_ref().unwrap() }}{% endif %} â€“ {% if job.end.is_some() %}{{ job.end.as_ref().unwrap() }}{% else %}Present{% endif %}
          </p>
          <ul>
            {% for note in job.notes %}
              <li>{{ note }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endfor %}
      </div>

      <div class="cv-section" id="education-tab">
        <h2>Education</h2>
        {% for qual in education.entries %}
        <div class="education">
          <h3>{{ qual.title }}</h3>
          <p class="education-details">
            {{ qual.provider }} | 
            {% if qual.description.is_some() %}{{ qual.description.as_ref().unwrap() }}{% endif %}
          </p>
          {% if qual.notes.len() > 0 %}
          <ul>
            {% for note in qual.notes %}
              <li>{{ note }}</li>
            {% endfor %}
          </ul>
          {% endif %}
        </div>
        {% endfor %}
      </div>

      <div class="cv-section" id="projects-tab">
        <h2>Notable Projects</h2>
        {% for proj in projects.entries %}
        <div class="project">
          <h3>{{ proj.title }}</h3>
          {% if proj.organisation.is_some() %}
            <p class="project-org">{{ proj.organisation.as_ref().unwrap() }}</p>
          {% endif %}
          {% if proj.description.is_some() %}
            <p>{{ proj.description.as_ref().unwrap() }}</p>
          {% endif %}
          {% if proj.tools_used.len() > 0 %}
            <!-- this is absurd but the askama parser is somehow not recognizing this if you add a space... -->
            <p class="project-tech">Technologies: {{ proj.tools_used| join(", ") }}</p>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock content %}